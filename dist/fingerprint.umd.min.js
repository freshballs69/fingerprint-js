!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Fingerprint={})}(this,function(e){"use strict";function t(e,t=0){let n=t>>>0;for(let t=0;t<e.length;t++){let r=e.charCodeAt(t);r=Math.imul(r,3432918353),r=r<<15|r>>>17,r=Math.imul(r,461845907),n^=r,n=n<<13|n>>>19,n=Math.imul(n,5)+3864292196}return n^=e.length,n^=n>>>16,n=Math.imul(n,2246822507),n^=n>>>13,n=Math.imul(n,3266489909),n^=n>>>16,n>>>0}function n(){const e=[],t=Object.getOwnPropertyNames(window),n={chrome:["chrome"],firefox:["InstallTrigger"],safari:["safari"],edge:["msWriteProfilerMark"],opera:["opr","opera"]};for(const[r,a]of Object.entries(n))for(const n of a)if(t.includes(n)||n in window){e.push(r);break}return e}function r(){try{document.cookie="fp_test=1";const e=-1!==document.cookie.indexOf("fp_test=");return document.cookie="fp_test=1; expires=Thu, 01 Jan 1970 00:00:00 UTC",e}catch(e){return!1}}function a(){const e=[];!0===navigator.webdriver&&e.push("navigator.webdriver");const t=Object.keys(document);for(const n of t)if(n.startsWith("$cdc_")||n.startsWith("$wdc_")){e.push("chromedriver");break}const n=window;(n.callPhantom||n._phantom||n.phantom)&&e.push("phantomjs"),n.__nightmare&&e.push("nightmare"),(n.domAutomation||n.domAutomationController)&&e.push("domAutomation"),(n._selenium||n.__webdriver_script_fn||n.__driver_evaluate||n.__webdriver_evaluate||n.__selenium_evaluate||n.__fxdriver_evaluate||n.__driver_unwrapped||n.__webdriver_unwrapped||n.__selenium_unwrapped||n.__fxdriver_unwrapped||n._Selenium_IDE_Recorder||n._WEBDRIVER_ELEM_CACHE)&&e.push("selenium"),n.__$webdriverAsyncExecutor&&e.push("webdriverAsyncExecutor"),(n.webdriver||n.__webdriverFunc)&&e.push("webdriverWindow"),n.Cypress&&e.push("cypress");return navigator.userAgent.toLowerCase().includes("headless")&&e.push("headlessUA"),{detected:e.length>0,signals:e}}function o(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return""}}function i(){try{return!!window.sessionStorage}catch(e){return!1}}function s(){try{return!!window.localStorage}catch(e){return!1}}function c(){try{return!!window.indexedDB}catch(e){return!1}}function l(){try{const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)return"";e.width=200,e.height=50,n.textBaseline="alphabetic",n.font="14px Arial",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText("Fingerprint",2,15),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillText("Canvas Test",4,45),n.globalCompositeOperation="multiply",n.fillStyle="rgb(255,0,255)",n.beginPath(),n.arc(50,50,50,0,2*Math.PI,!0),n.closePath(),n.fill(),n.fillStyle="rgb(0,255,255)",n.beginPath(),n.arc(100,50,50,0,2*Math.PI,!0),n.closePath(),n.fill();return t(e.toDataURL()).toString(16)}catch(e){return""}}const d=["Arial","Arial Black","Arial Narrow","Bookman Old Style","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Microsoft Sans Serif","Palatino Linotype","Tahoma","Times","Times New Roman","Trebuchet MS","Verdana","Wingdings"],u=["monospace","sans-serif","serif"];function f(){const e=[],t=document.createElement("canvas").getContext("2d");if(!t)return e;const n=e=>(t.font=`72px ${e}`,t.measureText("mmmmmmmmmmlli").width),r={};for(const e of u)r[e]=n(e);for(const t of d){let a=!1;for(const e of u){if(n(`"${t}", ${e}`)!==r[e]){a=!0;break}}a&&e.push(t)}return e}function h(){const e=[];if(!navigator.plugins)return e;for(let t=0;t<navigator.plugins.length;t++){const n=navigator.plugins[t];n&&e.push(n.name)}return e.sort()}async function g(e,t){const{url:n,method:r="POST",headers:a={}}=t;return await fetch(n,{method:r,headers:{"Content-Type":"application/json",...a},body:JSON.stringify(e)})}async function m(e={}){const d=new Set(e.excludeComponents||[]),u=d.has("webglVendor")&&d.has("webglRenderer")&&d.has("webglVersion")?{vendor:"",renderer:"",version:""}:function(){const e={vendor:"",renderer:"",version:""};try{const t=document.createElement("canvas"),n=t.getContext("webgl")||t.getContext("experimental-webgl");if(!(n&&n instanceof WebGLRenderingContext))return e;const r=n.getExtension("WEBGL_debug_renderer_info");r&&(e.vendor=n.getParameter(r.UNMASKED_VENDOR_WEBGL)||"",e.renderer=n.getParameter(r.UNMASKED_RENDERER_WEBGL)||""),e.version=n.getParameter(n.VERSION)||""}catch(e){}return e}(),g=d.has("audio")?0:await async function(){try{const e=window.AudioContext||window.webkitAudioContext;if(!e)return 0;const n=new e,r=n.createOscillator(),a=n.createAnalyser(),o=n.createGain(),i=n.createScriptProcessor(4096,1,1),s=n.destination;r.type="triangle",r.frequency.setValueAtTime(1e4,n.currentTime),o.gain.setValueAtTime(0,n.currentTime),r.connect(a),a.connect(i),i.connect(o),o.connect(s),r.start(0);const c=await new Promise(e=>{const n=new Float32Array(a.frequencyBinCount);a.getFloatFrequencyData(n),e(t(n.slice(0,50).join(",")))});return r.disconnect(),a.disconnect(),i.disconnect(),o.disconnect(),n.close(),c}catch(e){return 0}}(),m=d.has("webrtcAvailable")&&d.has("webrtcLocalIPs")?{available:!1,localIPs:[]}:await async function(){const e={available:!1,localIPs:[]};if("undefined"==typeof RTCPeerConnection)return e;e.available=!0;try{const t=new RTCPeerConnection({iceServers:[]}),n=new Set;return new Promise(r=>{const a=setTimeout(()=>{t.close(),e.localIPs=Array.from(n),r(e)},1e3);t.onicecandidate=o=>{if(!o.candidate)return clearTimeout(a),t.close(),e.localIPs=Array.from(n),void r(e);const i=o.candidate.candidate,s=i.match(/(\d{1,3}\.){3}\d{1,3}/);s&&n.add(s[0]);const c=i.match(/([a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/i);c&&n.add(c[0])},t.createDataChannel(""),t.createOffer().then(e=>t.setLocalDescription(e)).catch(()=>{clearTimeout(a),t.close(),r(e)})})}catch(t){return e}}();return{userAgent:d.has("userAgent")?"":navigator.userAgent,language:d.has("language")?"":navigator.language,languages:d.has("languages")?[]:Array.from(navigator.languages||[navigator.language]),colorDepth:d.has("colorDepth")?0:screen.colorDepth,screenResolution:d.has("screenResolution")?[0,0]:[screen.width,screen.height],availableScreenResolution:d.has("availableScreenResolution")?[0,0]:[screen.availWidth,screen.availHeight],timezone:d.has("timezone")?"":o(),timezoneOffset:d.has("timezoneOffset")?0:(new Date).getTimezoneOffset(),sessionStorage:!d.has("sessionStorage")&&i(),localStorage:!d.has("localStorage")&&s(),indexedDb:!d.has("indexedDb")&&c(),cookiesEnabled:!d.has("cookiesEnabled")&&r(),platform:d.has("platform")?"":navigator.platform,hardwareConcurrency:d.has("hardwareConcurrency")?0:navigator.hardwareConcurrency||0,deviceMemory:d.has("deviceMemory")?null:navigator.deviceMemory||null,maxTouchPoints:d.has("maxTouchPoints")?0:navigator.maxTouchPoints||0,vendor:d.has("vendor")?"":navigator.vendor||"",vendorFlavors:d.has("vendorFlavors")?[]:n(),canvas:d.has("canvas")?"":l(),webglVendor:d.has("webglVendor")?"":u.vendor,webglRenderer:d.has("webglRenderer")?"":u.renderer,webglVersion:d.has("webglVersion")?"":u.version,fonts:d.has("fonts")?[]:f(),audio:d.has("audio")?0:g,plugins:d.has("plugins")?[]:h(),doNotTrack:d.has("doNotTrack")?null:navigator.doNotTrack||null,webrtcAvailable:!d.has("webrtcAvailable")&&m.available,webrtcLocalIPs:d.has("webrtcLocalIPs")?[]:m.localIPs,webdriver:d.has("webdriver")?{detected:!1,signals:[]}:a()}}async function p(e={}){const t=await m(e),n=JSON.stringify(t);return{hash:await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}(n),components:t,timestamp:Date.now()}}function w(e,t){if(!e)return;const n=function(e,t){const n=new URL(e,window.location.origin);return n.searchParams.has("req_id")||n.searchParams.set("req_id",t),n.toString()}(e,t);fetch(n).catch(()=>{})}async function v(e={}){const t=await async function(){const e=await fetch("/api/v2/init"),t=await e.json();return{reqId:"string"==typeof t.req_id?t.req_id:null,trackUrl:"string"==typeof t.track_url?t.track_url:null}}();if(!t.reqId)return null;const n=await new Promise((t,n)=>{"complete"===document.readyState||"interactive"===document.readyState?p(e).then(t).catch(n):document.addEventListener("DOMContentLoaded",()=>{p(e).then(t).catch(n)})}),r=function(){var e,t,n;let r=null,a=null;if("undefined"!=typeof process&&((null===(e=process.env)||void 0===e?void 0:e.FINGERPRINT_API)?r=process.env.FINGERPRINT_API:(null===(t=process.env)||void 0===t?void 0:t.FINGERPRINT_ENDPOINT_URL)&&(r=process.env.FINGERPRINT_ENDPOINT_URL),(null===(n=process.env)||void 0===n?void 0:n.TRACK_API)&&(a=process.env.TRACK_API)),"undefined"!=typeof window){const e=window;e.FINGERPRINT_API?r=e.FINGERPRINT_API:e.FINGERPRINT_ENDPOINT_URL&&(r=e.FINGERPRINT_ENDPOINT_URL),e.TRACK_API&&(a=e.TRACK_API)}return r||(r="/api/v2/fingerprint"),{endpointUrl:r,trackUrl:a}}();let a=t.reqId;const o=t.trackUrl||r.trackUrl;if(r.endpointUrl)try{n.req_id=a;const e=await g(n,{url:r.endpointUrl});if((e.headers.get("content-type")||"").includes("application/json")){const t=await e.json();t&&"string"==typeof t.req_id&&(a=t.req_id)}}catch(e){}return w(o,a),a}const _={getFingerprint:p,collect:v,sendFingerprint:g},y=Object.assign(()=>_,_);"undefined"!=typeof window&&(window.Fingerprint=y),e.collect=v,e.default=y,e.getFingerprint=p,e.sendFingerprint=g,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=fingerprint.umd.min.js.map
