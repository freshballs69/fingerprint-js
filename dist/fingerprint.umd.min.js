!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).Fingerprint={})}(this,function(e){"use strict";function n(e,n=0){let t=n>>>0;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);r=Math.imul(r,3432918353),r=r<<15|r>>>17,r=Math.imul(r,461845907),t^=r,t=t<<13|t>>>19,t=Math.imul(t,5)+3864292196}return t^=e.length,t^=t>>>16,t=Math.imul(t,2246822507),t^=t>>>13,t=Math.imul(t,3266489909),t^=t>>>16,t>>>0}function t(){const e=[],n=Object.getOwnPropertyNames(window),t={chrome:["chrome"],firefox:["InstallTrigger"],safari:["safari"],edge:["msWriteProfilerMark"],opera:["opr","opera"]};for(const[r,o]of Object.entries(t))for(const t of o)if(n.includes(t)||t in window){e.push(r);break}return e}function r(){try{document.cookie="fp_test=1";const e=-1!==document.cookie.indexOf("fp_test=");return document.cookie="fp_test=1; expires=Thu, 01 Jan 1970 00:00:00 UTC",e}catch(e){return!1}}function o(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return""}}function a(){try{return!!window.sessionStorage}catch(e){return!1}}function i(){try{return!!window.localStorage}catch(e){return!1}}function c(){try{return!!window.indexedDB}catch(e){return!1}}function s(){try{const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)return"";e.width=200,e.height=50,t.textBaseline="alphabetic",t.font="14px Arial",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText("Fingerprint",2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText("Canvas Test",4,45),t.globalCompositeOperation="multiply",t.fillStyle="rgb(255,0,255)",t.beginPath(),t.arc(50,50,50,0,2*Math.PI,!0),t.closePath(),t.fill(),t.fillStyle="rgb(0,255,255)",t.beginPath(),t.arc(100,50,50,0,2*Math.PI,!0),t.closePath(),t.fill();return n(e.toDataURL()).toString(16)}catch(e){return""}}const l=["Arial","Arial Black","Arial Narrow","Bookman Old Style","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Microsoft Sans Serif","Palatino Linotype","Tahoma","Times","Times New Roman","Trebuchet MS","Verdana","Wingdings"],u=["monospace","sans-serif","serif"];function d(){const e=[],n=document.createElement("canvas").getContext("2d");if(!n)return e;const t=e=>(n.font=`72px ${e}`,n.measureText("mmmmmmmmmmlli").width),r={};for(const e of u)r[e]=t(e);for(const n of l){let o=!1;for(const e of u){if(t(`"${n}", ${e}`)!==r[e]){o=!0;break}}o&&e.push(n)}return e}function f(){const e=[];if(!navigator.plugins)return e;for(let n=0;n<navigator.plugins.length;n++){const t=navigator.plugins[n];t&&e.push(t.name)}return e.sort()}async function h(e,n){const{url:t,method:r="POST",headers:o={}}=n;return await fetch(t,{method:r,headers:{"Content-Type":"application/json",...o},body:JSON.stringify(e)})}async function g(e={}){const l=new Set(e.excludeComponents||[]),u=l.has("webglVendor")&&l.has("webglRenderer")&&l.has("webglVersion")?{vendor:"",renderer:"",version:""}:function(){const e={vendor:"",renderer:"",version:""};try{const n=document.createElement("canvas"),t=n.getContext("webgl")||n.getContext("experimental-webgl");if(!(t&&t instanceof WebGLRenderingContext))return e;const r=t.getExtension("WEBGL_debug_renderer_info");r&&(e.vendor=t.getParameter(r.UNMASKED_VENDOR_WEBGL)||"",e.renderer=t.getParameter(r.UNMASKED_RENDERER_WEBGL)||""),e.version=t.getParameter(t.VERSION)||""}catch(e){}return e}(),h=l.has("audio")?0:await async function(){try{const e=window.AudioContext||window.webkitAudioContext;if(!e)return 0;const t=new e,r=t.createOscillator(),o=t.createAnalyser(),a=t.createGain(),i=t.createScriptProcessor(4096,1,1),c=t.destination;r.type="triangle",r.frequency.setValueAtTime(1e4,t.currentTime),a.gain.setValueAtTime(0,t.currentTime),r.connect(o),o.connect(i),i.connect(a),a.connect(c),r.start(0);const s=await new Promise(e=>{const t=new Float32Array(o.frequencyBinCount);o.getFloatFrequencyData(t),e(n(t.slice(0,50).join(",")))});return r.disconnect(),o.disconnect(),i.disconnect(),a.disconnect(),t.close(),s}catch(e){return 0}}(),g=l.has("webrtcAvailable")&&l.has("webrtcLocalIPs")?{available:!1,localIPs:[]}:await async function(){const e={available:!1,localIPs:[]};if("undefined"==typeof RTCPeerConnection)return e;e.available=!0;try{const n=new RTCPeerConnection({iceServers:[]}),t=new Set;return new Promise(r=>{const o=setTimeout(()=>{n.close(),e.localIPs=Array.from(t),r(e)},1e3);n.onicecandidate=a=>{if(!a.candidate)return clearTimeout(o),n.close(),e.localIPs=Array.from(t),void r(e);const i=a.candidate.candidate,c=i.match(/(\d{1,3}\.){3}\d{1,3}/);c&&t.add(c[0]);const s=i.match(/([a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/i);s&&t.add(s[0])},n.createDataChannel(""),n.createOffer().then(e=>n.setLocalDescription(e)).catch(()=>{clearTimeout(o),n.close(),r(e)})})}catch(n){return e}}();return{userAgent:l.has("userAgent")?"":navigator.userAgent,language:l.has("language")?"":navigator.language,languages:l.has("languages")?[]:Array.from(navigator.languages||[navigator.language]),colorDepth:l.has("colorDepth")?0:screen.colorDepth,screenResolution:l.has("screenResolution")?[0,0]:[screen.width,screen.height],availableScreenResolution:l.has("availableScreenResolution")?[0,0]:[screen.availWidth,screen.availHeight],timezone:l.has("timezone")?"":o(),timezoneOffset:l.has("timezoneOffset")?0:(new Date).getTimezoneOffset(),sessionStorage:!l.has("sessionStorage")&&a(),localStorage:!l.has("localStorage")&&i(),indexedDb:!l.has("indexedDb")&&c(),cookiesEnabled:!l.has("cookiesEnabled")&&r(),platform:l.has("platform")?"":navigator.platform,hardwareConcurrency:l.has("hardwareConcurrency")?0:navigator.hardwareConcurrency||0,deviceMemory:l.has("deviceMemory")?null:navigator.deviceMemory||null,maxTouchPoints:l.has("maxTouchPoints")?0:navigator.maxTouchPoints||0,vendor:l.has("vendor")?"":navigator.vendor||"",vendorFlavors:l.has("vendorFlavors")?[]:t(),canvas:l.has("canvas")?"":s(),webglVendor:l.has("webglVendor")?"":u.vendor,webglRenderer:l.has("webglRenderer")?"":u.renderer,webglVersion:l.has("webglVersion")?"":u.version,fonts:l.has("fonts")?[]:d(),audio:l.has("audio")?0:h,plugins:l.has("plugins")?[]:f(),doNotTrack:l.has("doNotTrack")?null:navigator.doNotTrack||null,webrtcAvailable:!l.has("webrtcAvailable")&&g.available,webrtcLocalIPs:l.has("webrtcLocalIPs")?[]:g.localIPs}}async function m(e={}){const n=await g(e),t=JSON.stringify(n);return{hash:await async function(e){const n=(new TextEncoder).encode(e),t=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}(t),components:n,timestamp:Date.now()}}function p(e,n){if(!e)return;const t=function(e,n){const t=new URL(e,window.location.origin);return t.searchParams.has("req_id")||t.searchParams.set("req_id",n),t.toString()}(e,n);fetch(t).catch(()=>{})}async function w(e={}){const n=await async function(){const e=await fetch("/api/init"),n=await e.json();return{reqId:"string"==typeof n.req_id?n.req_id:null,trackUrl:"string"==typeof n.track_url?n.track_url:null}}();if(!n.reqId)return null;const t=await new Promise((n,t)=>{"complete"===document.readyState||"interactive"===document.readyState?m(e).then(n).catch(t):document.addEventListener("DOMContentLoaded",()=>{m(e).then(n).catch(t)})}),r=function(){var e,n,t;let r=null,o=null;if("undefined"!=typeof process&&((null===(e=process.env)||void 0===e?void 0:e.FINGERPRINT_API)?r=process.env.FINGERPRINT_API:(null===(n=process.env)||void 0===n?void 0:n.FINGERPRINT_ENDPOINT_URL)&&(r=process.env.FINGERPRINT_ENDPOINT_URL),(null===(t=process.env)||void 0===t?void 0:t.TRACK_API)&&(o=process.env.TRACK_API)),"undefined"!=typeof window){const e=window;e.FINGERPRINT_API?r=e.FINGERPRINT_API:e.FINGERPRINT_ENDPOINT_URL&&(r=e.FINGERPRINT_ENDPOINT_URL),e.TRACK_API&&(o=e.TRACK_API)}return r||(r="/api/fingerprint"),{endpointUrl:r,trackUrl:o}}();let o=n.reqId;const a=n.trackUrl||r.trackUrl;if(r.endpointUrl)try{t.req_id=o;const e=await h(t,{url:r.endpointUrl});if((e.headers.get("content-type")||"").includes("application/json")){const n=await e.json();n&&"string"==typeof n.req_id&&(o=n.req_id)}}catch(e){}return p(a,o),o}const v={getFingerprint:m,collect:w,sendFingerprint:h},y=Object.assign(()=>v,v);"undefined"!=typeof window&&(window.Fingerprint=y),e.collect=w,e.default=y,e.getFingerprint=m,e.sendFingerprint=h,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=fingerprint.umd.min.js.map
